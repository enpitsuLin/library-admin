(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f81faf2"],{"006a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("page-header-wrapper",[r("a-card",{staticClass:"card",attrs:{title:"基本信息",bordered:!1}},[r("a-form",{staticClass:"form",attrs:{form:e.form}},[r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{lg:8,md:12,sm:24}},[r("a-form-item",{attrs:{label:"书名"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"请输入书籍名称"}]}],expression:"[\n                'title',\n                {\n                  rules: [\n                    {\n                      required: true,\n                      message: '请输入书籍名称',\n                    },\n                  ],\n                },\n              ]"}],attrs:{placeholder:"请输入书籍名称"}})],1)],1),r("a-col",{attrs:{lg:8,md:12,sm:24}},[r("a-form-item",{attrs:{label:"出版社"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["pub",{rules:[{required:!0,message:"请输入出版社名"}]}],expression:"[\n                'pub',\n                {\n                  rules: [\n                    {\n                      required: true,\n                      message: '请输入出版社名',\n                    },\n                  ],\n                },\n              ]"}],attrs:{placeholder:"请输入"}})],1)],1),r("a-col",{attrs:{lg:8,md:12,sm:24}},[r("a-form-item",{attrs:{label:"ISBN"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["isbn",{rules:[{required:!0,message:"请输入ISBN码"}]}],expression:"[\n                'isbn',\n                {\n                  rules: [\n                    {\n                      required: true,\n                      message: '请输入ISBN码',\n                    },\n                  ],\n                },\n              ]"}],attrs:{placeholder:"请输入ISBN码"}})],1)],1)],1),r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{lg:16,md:24,sm:24}},[e._l(e.form.getFieldValue("creators"),(function(t){return r("a-form-item",{key:t,staticStyle:{"margin-bottom":"2px"},attrs:{required:0===t,label:0===t?"责任者":""}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["creatorName["+t+"]",{rules:[{required:!0,message:0===t?"请输入责任者":"请输入责任者或删除该项"}]}],expression:"[\n                `creatorName[${index}]`,\n                {\n                  rules: [\n                    {\n                      required: true,\n                      message:\n                        index === 0\n                          ? '请输入责任者'\n                          : '请输入责任者或删除该项',\n                    },\n                  ],\n                },\n              ]"}],attrs:{placeholder:"责任者名称"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["creatorType["+t+"]",{initialValue:"mian"}],expression:"[\n                  `creatorType[${index}]`,\n                  { initialValue: 'mian' },\n                ]"}],attrs:{slot:"addonBefore",placeholder:"责任者类型"},slot:"addonBefore"},[r("a-select-option",{attrs:{value:"mian"}},[e._v("主要责任者")]),r("a-select-option",{attrs:{value:"addition"}},[e._v("次要责任者")])],1),r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["creatorMethod["+t+"]",{initialValue:"著"}],expression:"[\n                  `creatorMethod[${index}]`,\n                  { initialValue: '著' },\n                ]"}],staticStyle:{width:"80px"},attrs:{slot:"addonAfter",placeholder:"责任者类型"},slot:"addonAfter"},[r("a-select-option",{attrs:{value:"著"}},[e._v("著")]),r("a-select-option",{attrs:{value:"编著"}},[e._v("编著")]),r("a-select-option",{attrs:{value:"译"}},[e._v("译")]),r("a-select-option",{attrs:{value:"编译"}},[e._v("编译")])],1)],1)],1)})),r("a-form-item",[r("a-button-group",{staticStyle:{width:"100%"}},[r("a-button",{staticStyle:{width:"65%"},attrs:{type:"dashed"},on:{click:e.add}},[r("a-icon",{attrs:{type:"plus"}}),e._v(" 添加责任者 ")],1),r("a-button",{staticStyle:{width:"35%"},attrs:{type:"dashed",disabled:1===e.form.getFieldValue("creators").length},on:{click:function(t){return e.remove()}}},[r("a-icon",{attrs:{type:"delete"}}),e._v(" 删除责任者 ")],1)],1)],1)],2),r("a-col",{attrs:{lg:8,md:24,sm:24}},[r("a-form-item",{attrs:{label:"语言"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["language",{initialValue:"zh-CN"}],expression:"['language', { initialValue: 'zh-CN' }]"}]},[r("a-select-option",{attrs:{value:"zh-CN"}},[e._v("汉语")]),r("a-select-option",{attrs:{value:"ja-JP"}},[e._v("日语")]),r("a-select-option",{attrs:{value:"en-US"}},[e._v("英语")])],1)],1)],1),r("a-col",{attrs:{lg:12,md:24,sm:24}},[r("a-form-item",{attrs:{label:"分类号"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["class"],expression:"['class']"}],attrs:{placeholder:"请输入分类号"}})],1)],1),r("a-col",{attrs:{lg:12,md:24,sm:24}},[r("a-form-item",{attrs:{label:"索书号"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["call"],expression:"['call']"}],attrs:{placeholder:"请输入索书号"}})],1)],1)],1),r("a-row",[r("a-col",[r("a-form-item",{attrs:{label:"备注"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["note"],expression:"['note']"}],attrs:{type:"textarea"}})],1)],1)],1)],1)],1),r("footer-tool-bar",{attrs:{"is-mobile":e.isMobile,collapsed:e.sideCollapsed}},[r("span",{staticClass:"popover-wrapper"},[r("a-popover",{attrs:{title:"校验信息",overlayClassName:"antd-pro-pages-forms-style-errorPopover",trigger:"click",getPopupContainer:function(e){return e.parentNode}}},[r("template",{slot:"content"},e._l(e.errors,(function(t){return r("li",{key:t.key,staticClass:"antd-pro-pages-forms-style-errorListItem",on:{click:function(r){return e.scrollToField(t.key)}}},[r("a-icon",{staticClass:"antd-pro-pages-forms-style-errorIcon",attrs:{type:"cross-circle-o"}}),r("div",{},[e._v(e._s(t.message))]),r("div",{staticClass:"antd-pro-pages-forms-style-errorField"},[e._v(" "+e._s(t.fieldLabel)+" ")])],1)})),0),e.errors.length>0?r("span",{staticClass:"antd-pro-pages-forms-style-errorIcon"},[r("a-icon",{attrs:{type:"exclamation-circle"}}),e._v(e._s(e.errors.length)+" ")],1):e._e()],2)],1),r("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.validate}},[r("span",[e._v("提交")])])],1)],1)},o=[],n=(r("99af"),r("4de4"),r("4160"),r("d81d"),r("b64b"),r("d3b7"),r("159b"),r("15fd")),i=r("5530"),s=r("b85c"),l=r("5a70"),c=r("432b"),d={title:"书名",pub:"出版社",isbn:"ISBN",creatorName:"责任者"},u=0,f={name:"BookAddForm",mixins:[c["a"]],data:function(){return{loading:!1,errors:[]}},components:{FooterToolBar:l["a"]},beforeCreate:function(){this.form=this.$form.createForm(this),this.form.getFieldDecorator("creators",{initialValue:[],preserve:!0});var e=this.form.getFieldValue("creators");this.form.setFieldsValue({creators:e.concat(u++)})},methods:{handleSubmit:function(e){e.preventDefault()},remove:function(){var e=this.form,t=e.getFieldValue("creators");1!==t.length&&e.setFieldsValue({creators:t.filter((function(e){return e!==t[t.length-1]}))})},add:function(){var e=this.form,t=e.getFieldValue("creators"),r=t.concat(u++);e.setFieldsValue({creators:r})},validate:function(){var e=this,t=this.$createElement,r=this.form,a=this.$notification,o=new Promise((function(e,t){r.validateFields((function(r){if(r){var a={},o=0;if(Object.keys(r).filter((function(e){return r[e]})).forEach((function(e){if(Array.isArray(r[e])){var t,n=Object(s["a"])(r[e]);try{for(n.s();!(t=n.n()).done;){var i=t.value;a[e+"[".concat(o++,"]")]=i}}catch(r){n.e(r)}finally{n.f()}}else a[e]=r[e]})),a)return void t(a)}e()}))})).catch((function(){}));this.errors=[],o.then((function(){r.validateFields((function(r,o){if(r){var l={},c=0,d=Object.assign({},e.form.getFieldsError());if(Object.keys(d).filter((function(e){return d[e]})).forEach((function(e){if("creatorMethod"!=e&&"creatorType"!=e)if(Array.isArray(d[e][0])){var t,a=Object(s["a"])(d[e]);try{for(a.s();!(t=a.n()).done;){var o=t.value;l[e+"[".concat(c++,"]")]=o}}catch(r){a.e(r)}finally{a.f()}}else l[e]=d[e]})),"creatorName"===Object.keys(l)[0]&&1==Object.keys(l).length)return;var u=Object(i["a"])({},l);e.errorList(u)}else{o.creatorType,o.creators,o.creatorName,o.creatorMethod;var f=Object(n["a"])(o,["creatorType","creators","creatorName","creatorMethod"]);f.creator={main:[],method:"",addition:[]};for(var m=0;m<=o.creatorType.length-1;m++)"mian"==o.creatorType[m]?(f.creator.main.push(o.creatorName[m]),f.creator.method=o.creatorMethod[m]):f.creator.addition.push({title:o.creatorName[m],method:o.creatorMethod[m]});e.$http.post("/books/add/",f).then((function(e){"BOOK ADD SUCCESS"==e.msg?a.open({message:"书籍添加成功",description:"书籍".concat(f.title,"添加成功"),icon:t("a-icon",{attrs:{type:"smile"},style:"color: #108ee9"})}):a.warning({message:"书籍添加失败",description:"书籍".concat(f.title,"添加失败,请检查网络连接！"),icon:t("a-icon",{attrs:{type:"smile"},style:"color: #108ee9"})})}))}}))}))},errorList:function(e){e&&0!==e.length&&(this.errors=Object.keys(e).filter((function(t){return e[t]})).map((function(t){return{key:t,message:e[t][0],fieldLabel:d[t]||d.creatorName}})))},scrollToField:function(e){var t=document.getElementById(e);t&&t.scrollIntoView(!0)}}},m=f,p=(r("b36c"),r("2877")),v=Object(p["a"])(m,a,o,!1,null,"13bfddf4",null);t["default"]=v.exports},"15fd":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("a4d3"),r("c975"),r("b64b");function a(e,t){if(null==e)return{};var r,a,o={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(o[r]=e[r]);return o}function o(e,t){if(null==e)return{};var r,o,n=a(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}},"2da5":function(e,t,r){},"4df4":function(e,t,r){"use strict";var a=r("0366"),o=r("7b0b"),n=r("9bdd"),i=r("e95a"),s=r("50c4"),l=r("8418"),c=r("35a1");e.exports=function(e){var t,r,d,u,f,m,p=o(e),v="function"==typeof this?this:Array,h=arguments.length,b=h>1?arguments[1]:void 0,y=void 0!==b,g=c(p),w=0;if(y&&(b=a(b,h>2?arguments[2]:void 0,2)),void 0==g||v==Array&&i(g))for(t=s(p.length),r=new v(t);t>w;w++)m=y?b(p[w],w):p[w],l(r,w,m);else for(u=g.call(p),f=u.next,r=new v;!(d=f.call(u)).done;w++)m=y?n(u,b,[d.value,w],!0):d.value,l(r,w,m);return r.length=w,r}},a630:function(e,t,r){var a=r("23e7"),o=r("4df4"),n=r("1c7e"),i=!n((function(e){Array.from(e)}));a({target:"Array",stat:!0,forced:i},{from:o})},b36c:function(e,t,r){"use strict";var a=r("2da5"),o=r.n(a);o.a},b85c:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0"),r("a630"),r("fb6a"),r("b0c0"),r("25f0");function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function o(e,t){if(e){if("string"===typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function n(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==r["return"]||r["return"]()}finally{if(l)throw i}}}}}}]);
//# sourceMappingURL=chunk-5f81faf2.57ac6c0a.js.map